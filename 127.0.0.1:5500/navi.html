<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>지도 생성하기</title>
    
</head>
<body>
<!-- 지도를 표시할 div 입니다 -->
<div id="map" style="width:100%;height:350px;"></div>

<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=4c754f50381769b1f82ae5d7b94f43f0
"></script>
<script>
var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
    mapOption = { 
        center: new kakao.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
        level: 3 // 지도의 확대 레벨
    };

// 지도를 표시할 div와  지도 옵션으로  지도를 생성합니다
var map = new kakao.maps.Map(mapContainer, mapOption); 

var markerPosition  = new kakao.maps.LatLng(33.450701, 126.570667); 

// 마커를 생성합니다
var marker = new kakao.maps.Marker({
    position: markerPosition
});

// 마커가 지도 위에 표시되도록 설정합니다
marker.setMap(map)

const respharmacy = function(authKey) {
    var urls = "https://openapi.gg.go.kr/Animalhosptl"
    const option = {
        KEY:authKey,
        Type: "json",
        pIndex: "1",
        pSize: '100',
        SIGUN_CD: city
    }
    request.get({
        uri: urls,
        qs: option,
    }, function(err, res, body) {
        let json = JSON.parse(body)
        let logt = {};
        let lat = {};
        let name = {};
        for(let i=0; i<phaData.AnimalPharmacy[1].row.length; i++) {
            logt[i] = phaData.AnimalPharmacy[1].row[i].REFINE_WGS84_LOGT
            lat[i] = phaData.AnimalPharmacy[1].row[i].REFINE_WGS84_LAT
            name[i] = phaData.AnimalPharmacy[1].row[i].BIZPLC_NM
        }
        let data = {
            logt : logt,
            lat : lat,
            name : name
        }
        pRes.render('findmap.ejs', data);
    })

    for(let i = 0; i<Object.keys(logt).length; i++) {
        var imageSize = new kakao.maps.Size(24,35);
        var markerImage = new kakao.maps.MarkerIamgr(imageSrc, imageSize);

        console.log(logt[i], lat[i])
        var marker = new kakao.maps.Marker({
            map:map,
            position: new kakao.maps.LatLng(lat[i],loht[i]),
            title : name[i],
            image : markerImage
        });
    }
}
</script>
</body>
</html>
